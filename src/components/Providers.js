import React, { useState , useEffect, useRef } from "react";import {	View,	Text,	Image,	TouchableOpacity,	ImageBackground,	KeyboardAvoidingView,	I18nManager,	Dimensions,	FlatList,	ActivityIndicator} from "react-native";import {Container, Button, Form, Input, Toast, Header, Right, Left, Body, Icon} from 'native-base'import styles from '../../assets/styles'import i18n from "../../locale/i18n";import Carousel from 'react-native-snap-carousel';import {useSelector, useDispatch} from 'react-redux';import {getProviders} from '../actions';import COLORS from "../consts/colors";const width		 = Dimensions.get('window').width;const height	 = Dimensions.get('window').height;const images = [	require('../../assets/images/slider_1.png'),	require('../../assets/images/slider_2.png'),	require('../../assets/images/slider_3.png'),	require('../../assets/images/slider_4.png'),];function Providers({navigation, route}) {	let { data } 		= route.params;	const lang   		= useSelector(state => state.lang.lang);	const providers  	= useSelector(state => state.providers.providers)	const loader 		= useSelector(state => state.providers.loader)	const dispatch = useDispatch();	function fetchData(){		const subCategories = data.subCategories;		dispatch(getProviders(lang, subCategories))	}	useEffect(() => {		fetchData();		const unsubscribe = navigation.addListener('focus', () => {			fetchData();		});		return unsubscribe;	}, [navigation , loader]);	function renderLoader(){		if (loader === false){			return(				<View style={[styles.loading, styles.flexCenter, {height:'100%'}]}>					<ActivityIndicator size="large" color={COLORS.blue} style={{ alignSelf: 'center' }} />				</View>			);		}	}	function _renderItem(item) {		return(			<View key={item.index} style={{ borderRadius: 10, overflow: 'hidden', height: 150, width: width*85/100}}>				<Image source={images[item.index]} resizeMode={'cover'} style={[ { height: 160, width: '100%', borderRadius: 10 }]}/>			</View>		)	}	function Item({ name , image , rate , index, category , id }) {		return (			<TouchableOpacity onPress={() => navigation.navigate('providerDetails')} key={'_' + index} style={{ borderRadius: 10, height: 200, width: '47%', margin: 5, overflow: 'hidden'  }}>				<ImageBackground source={image} resizeMode={'cover'} style={{ height: 200, width: '100%', borderRadius: 10 }}>					<View style={[styles.overlay_black , styles.Width_100, { zIndex: 0, height: 200, position: 'absolute' }]} />					<View style={{ bottom: 0, position: 'absolute', width: '100%', height: 60, flexDirection: 'row', paddingHorizontal: 10 }}>						<View>							<Text style={[ styles.textBold, styles.text_White, styles.textSize_16 ]}>{ name }</Text>							<Text style={[ styles.textRegular, styles.text_White, styles._alignText, styles.textRight ]}>{ category }</Text>						</View>						<View style={{ position: 'absolute', right: 10, alignItems: 'center', marginTop: 10 }}>							<Icon type={'AntDesign'} name={'star'} style={{ color: 'yellow', fontSize: 16 }} />							<Text style={[ styles.textRegular, styles.text_White, styles._alignText ]}>{ rate }</Text>						</View>					</View>				</ImageBackground>			</TouchableOpacity>		);	}	return (		<Container>			{ renderLoader() }			<ImageBackground source={require('../../assets/images/menu_bg.png')} style={{ width, height, alignSelf: 'center', flexGrow: 1 }} resizeMode={'cover'}>				<Header style={{ backgroundColor: 'transparent', marginTop: 10, borderBottomWidth: 0 }} noShadow>					<Right style={{ flex: 0, marginLeft: 10 }}>						<TouchableOpacity onPress={() => navigation.openDrawer()} style={{ width: 50, height: 50, justifyCenter: 'center', alignItems: 'center' }}>							<Image source={require('../../assets/images/menu.png')} style={{ width: 27, height: 27, marginTop: 10 }} resizeMode={'contain'}/>						</TouchableOpacity>					</Right>					<Body style={{ alignSelf: 'center', flex: 1 }}>					<Text style={{ textAlign: 'center', width: '100%', color: '#fff', fontSize: 24, fontFamily: 'ArbFONTSBold' }}>سفاري</Text>					</Body>					<Left style={{ flex: 0 }}>						<TouchableOpacity style={{ width: 50, height: 50, justifyCenter: 'center', alignItems: 'center' }}>							<Image source={require('../../assets/images/notification.png')} style={{ width: 25, height: 25, marginTop: 10 }} resizeMode={'contain'}/>						</TouchableOpacity>					</Left>				</Header>				<View contentContainerStyle={[styles.bgFullWidth ]}>					<View style={styles.searchBox}>						<Icon type={'AntDesign'} name={'search1'} style={{ color: '#fff', fontSize: 20 }} />						<Input placeholder={i18n.t('search')} style={styles.searchInput}/>						<TouchableOpacity>							<Icon type={'AntDesign'} name={ I18nManager.isRTL ? 'arrowleft' : 'arrowright'} style={{ color: '#fff', fontSize: 20 }} />						</TouchableOpacity>					</View>					<View style={[ styles.boxShadow, { position: 'absolute', width: '80%', height: 150, borderRadius: 10, zIndex: 1, alignSelf: 'center', alignItems: 'center', justifyContent: 'center', marginTop: 70 }]}>						<Carousel							data={images}							layout={'default'}							renderItem={_renderItem}							sliderWidth={width}							itemWidth={width*83/100}							autoplay={true}						/>					</View>					<View style={[styles.mapView, { bottom: -80, paddingTop: 95, paddingHorizontal: 15, alignItems: 'flex-start', paddingBottom: 70 }]}>						<Text style={[ styles.textBold, styles.textSize_20, styles._alignText, styles.marginVertical_15, { alignSelf: 'flex-start' } ]}>{ i18n.t('providers') }</Text>						{							providers ?								<FlatList									data={providers}									renderItem={({ item , index}) => <Item										name={item.name}										index={index}										image={item.image}										category={item.category}										rate={item.rate}										id={item.id}									/>}									keyExtractor={item => item.id}									numColumns={2}									horizontal={false}									columnWrapperStyle={[styles.directionRowCenter]}									// extraData={isFav}								/> : null						}					</View>				</View>			</ImageBackground>		</Container>	)}export default Providers;